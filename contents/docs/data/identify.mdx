---
title: Identifying users
sidebar: Docs
showTitle: true
availability:
    free: full
    selfServe: full
    enterprise: full

---
Linking events to specific users enables you to gain full insights as to how they're using your product across different sessions, devices, and platforms. 

This is straight forward to do when [capturing backend events](/docs/getting-started/send-events#3-capture-backend-events), as you associate events to a specific user using `distinct_id`, which is a required argument. However, on the [frontend]((/docs/getting-started/send-events#sending-custom-properties-on-an-event)), this is not a required argument and thus events can be submitted anonymously. In order to link events from anonymous to specific users, you need to use `identify`:

<MultiLanguage selector="tabs">

```javascript
posthog.identify(
    'distinct_id',
    { email: 'max@hedgehogmail.com', name: 'Max Hedgehog' } 
    {}, 
);
```

```Android
PostHog.with(this)
       .identify(distinctID, new Properties()
                                .putValue("name", "My Name")
                                .putValue("email", "user@posthog.com"));
```

```iOS
posthog.identify("distinct_id", 
          properties: ["name": "Max Hedgehog", "email": "max@hedgehogmail.com"])
```

</MultiLanguage>

## How `identify` works

When a user starts browsing your website or app, they'll be automatically assigned an **anonymous ID**, which is then stored locally. This allows us to track anonymous users – even across different sessions. This anonymous ID is created using the user's device ID.

> Note that depending on your [persistence configuration](/docs/libraries/js#persistence), the anonymous ID may not be stored, and thus regenerated across sessions.

By calling `identify` with a `distinct_id` of your choice (usually their ID in your database, or their email), you are linking the anonymous ID and distinct ID together. Thus all past and future events made with that anonymous ID are now associated with the distinct ID. This enables you to do things like associate events with a user from before they log in for the first time, or associate their events across different devices or platforms.

> **A note on using `identify` in the backend:**
>
> Although it is technically possible to call `identify` using our backend SDKs, it is typically most useful in frontends. This is because there is no concept of anonymous sessions in the backend SDKs.

## Best practices when using `identify`

### 1. Call `identify` as soon as you're able to

In your frontend, you should call identify as soon as you're able to. Typically, this is every time your app loads for the first time, or directly after your users log in. This ensures that events sent during your users' sessions are correctly associated with them. 

You only need to call `identify` once per session.

### 2. Use unique strings for Distinct IDs

If two users have the same distinct ID, their data will be merged and they will be considered as one user in PostHog. Two common ways in which this can happen are:

- Your logic for generating IDs does not generate sufficiently strong IDs and you can end up with a clash where 2 users have the same ID.
- There's a bug, typo, or mistake in your code leading to most or all users being identified with generic IDs like `null`, `true`, or `distinctId`.

PostHog also has a few built-in protections to stop the most common distinct ID mistakes:

- We do not allow identifying users with empty space strings of any length – e.g.,`' '`, `'       '`, etc.
- We do not allow identifying users with the following strings (case insensitive):
    - `anonymous`
    - `guest`
    - `distinctid`
    - `distinct_id`
    - `id`
    - `not_authenticated`
    - `email`
    - `undefined`
    - `true`
    - `false`

- We do not allow identifying users with the following strings (case sensitive):
  - `[object Object]` 
  - `NaN`
  - `None`
  - `none`
  - `null`
  - `0`
  
### 3. Reset after logout

If a user logs out on your frontend, you should call `reset` to unlink any future events made on that device with that user. 

This is important if your users are sharing a computer, as otherwise all of those users will be grouped together into a single user due to shared cookies between sessions. **We strongly recommend you do this on logout even if you don't expect users to share a computer.**

You can do that like so:

<MultiLanguage selector="tabs">

```javascript
posthog.reset()
```

```iOS
posthog.reset()
```
```Android
PostHog.with(this)
       .reset();
```

</MultiLanguage>

If you _also_ want to reset the `device_id` so that the device will be considered a new device in future events, you can pass `true` as an argument:

<MultiLanguage selector="tabs">

```javascript
posthog.reset()
```

```iOS
posthog.reset(true)
```

```Android
PostHog.with(this)
       .reset(true);
```
</MultiLanguage>

### 4. Setting user properties

You'll notice that one of the parameters in the `identify` method is a `properties` object. This enables you to set [user properties](/docs/getting-started/user-properties). Whenever possible, we recommend passing in all user properties you have available each time you call identify, as this will ensure that their user profile on PostHog is up to date.

User properties can also be set using a `capture` and not only with `identify`. See our [user properties docs](/docs/getting-started/user-properties) for more details on how to work with them and best practices.

## Alias: Assigning multiple distinct IDs to the same user 

Sometimes you may want to assign multiple distinct IDs to a single user. This is helpful in scenarios where your primary distinct ID may be inaccessible. For example, if a distinct ID which is typically used on the frontend is not available in certain parts of your backend code. In this case, you can use `alias` to assign another distinct ID to the same user:

In the below example, we assign the user with `distinct_id` another ID: `alias_id`. This means that any events submitted using either `distinct_id` or `alias_id` will be associated with the same user.

<MultiLanguage selector="tabs">

```node
client.alias({
    distinctId: 'distinct_id',
    alias: 'alias_id',
})
```

```javascript
posthog.alias('alias_id', 'distinct_id');
```

```python
posthog.alias('distinct_id', 'alias_id', );
```

```php
PostHog::alias(array(
  'distinctId' => 'distinct_id',
  'alias' => 'alias_id'
));
```

```ruby
posthog.alias({
  distinct_id: "distinct_id",
  alias: "alias_id",
})
```

```go
client.Enqueue(posthog.Alias{
  DistinctId: "distinct_id",
  Alias: "alias_id",
})
```

```java
posthog.alias("distinct_id", "alias_id");
```

```bash
curl -v -L --header "Content-Type: application/json" -d '{
    "api_key": "<ph_project_api_key>",
    "properties": {
        "distinct_id": "distinct_id",
        "alias": "alias_id"
    },
    "timestamp": "2020-08-16 09:03:11.913767",
    "event": "$create_alias"
}' https://app.posthog.com/capture/
```

</MultiLanguage>

There are two requirements when assigning an `alias_id`:

1. It cannot be associated with more than one `distinct_id`.
2. The `alias_id` **must not** be the `distinct_id` of any other user. For example:

<MultiLanguage selector="tabs">

```node
// ❌ Not possible. 
client.alias({
    distinctId: 'distinct_id',
    alias: 'distinct_id_of_another_user',
})
```

```javascript
// ❌ Not possible. 
client.alias({
    distinctId: 'distinct_id',
    alias: 'distinct_id_of_another_user',
})
```

```python
# ❌ Not possible
posthog.alias('distinct_id_of_another_user', 'distinct_id');
```

```php
# ❌ Not possible
PostHog::alias(array(
  'distinctId' => 'distinct_id',
  'alias' => 'distinct_id_of_another_user'
));
```

```ruby
# ❌ Not possible
posthog.alias({
  distinct_id: "distinct_id",
  alias: "distinct_id_of_another_user",
})
```

```go
// ❌ Not possible
client.Enqueue(posthog.Alias{
  DistinctId: "distinct_id",
  Alias: "distinct_id_of_another_user",
})
```

```java
// ❌ Not possible
posthog.alias("distinct_id", "distinct_id_of_another_user");
```

</MultiLanguage>

If we encounter an `identify` or `alias` event with one of the above problems, the following will happen:

1. We process the event normally (it will be ingested and show up in the UI)
2. Merging users will be refused and an ingestion warning will be logged (see [ingestion warnings](/manual/data-management#ingestion-warnings) for more details).
3. The event will be only be tied to the user associated with `distinct_id`

## Troubleshooting and FAQs

### How are properties managed when identifying anonymous users?

When an anonymous user is identified as `User A`, all the properties of the anonymous user are added to `User A`. If there is a conflict, the properties of `User A` are prioritized over the anonymous user. For example:

```js
client.identify({
    distinctId: 'user_A',
    properties: {
        name: 'User A',
        location: 'London',
        timezone: 'GMT',
    },
})

client.reset()

// as an anonymous user
posthog.people.set({ 
    name: 'Anonymous User',
    phone: '0800-POSTHOG' 
})

client.identify({
    distinctId: 'user_A',
    properties: {
        timezone: 'GMT+8',
    },
})

/* User A will now have properties:
{ 
  name: 'User A',
  location: 'London', 
  phone: '0800-POSTHOG', 
  timezone: 'GMT+8' 
}
*/
```

### How to handle duplicates of the same user

It may happen that, due to implementation issues, the same user in your product has multiple users in PostHog associated with them. In these cases, you can use `$merge_dangerously` to merge multiple PostHog users into a single user.
   
> **Warning:** Merging users with `merge_dangerously` is irreversible and has no safeguards! Be careful not to merge users who should not be merged together.
> 
> Due to the dangers, we don't recommend you merge users frequently, but rather as a one-off for recovering from implementation problems. We also encourage you to consider whether merging users is strictly necessary for your data integrity, or a 'nice to have'.

Merging users is done by sending a `$merge_dangerously` event:

<MultiLanguage selector="tabs">

```node
client.capture({
    distinctId: 'distinct_id_of_user_to_merge_into',
    event: '$merge_dangerously',
    properties: {
        alias: 'distinct_id_of_user_to_be_merged',
    },
})
```

```py
posthog.capture('distinct_id_of_user_to_merge_into', 
  '$merge_dangerously', 
  {'alias': 'distinct_id_of_user_to_be_merged'})
```

```go
client.Enqueue(posthog.Capture{
  DistinctId: "distinct_id_of_user_to_merge_into",
  Event:      "$merge_dangerously",
  Properties: posthog.NewProperties().
    Set("alias", "distinct_id_of_user_to_be_merged"),
})
```

```ruby
posthog.capture({
    distinct_id: 'distinct_id_of_user_to_merge_into',
    event: '$merge_dangerously',
    properties: {
        alias: 'distinct_id_of_user_to_be_merged'
    }
})
```

```bash
curl -v -L --header "Content-Type: application/json" -d '{
    "api_key": "<ph_project_api_key>",
    "properties": {
      "alias": "distinct_id_of_user_to_be_merged"
    },
    "timestamp": "2020-08-16 09:03:11.913767",
    "distinct_id": "distinct_id_of_user_to_merge_into",
    "event": "$merge_dangerously"
}' https://app.posthog.com/capture/
```

</MultiLanguage>

#### How are properties managed when merging users?


When a `User B` is merged into another `User A`, all the properties of the `User B` are added to `User A`. If there is a conflict, the properties of `User A` are prioritized over `User B`. For example:
```js
client.identify({
    distinctId: 'user_A',
    properties: {
        location: 'London',
        name: 'User A',
    },
})

client.identify({
    distinctId: 'user_B',
    properties: {
        name: 'User B',
        location: 'Rome',
        phone: '0800-POSTHOG',
    },
})

posthog.alias(
  'user_A', // distinct_id
  'user_B'  // alias_id
)

/* User B has merged into User A. User A will now have properties:
{ 
  name: 'User A',
  location: 'London', 
  phone: '0800-POSTHOG', 
}
*/
```

### How to split a merged user back into separate users

If you've accidentally linked an incorrect anonymous ID with a specific distinct ID, or you've made a mistake when merging users, it's possible to split their combined user back into separate users. You can do this in the PostHog app by navigating to the user you'd like split, and then clicking "Split IDs" in the top right corner. 

> **Warning:** This may change the numbers in your charts, even historically. We also cannot guarantee that historical data will be assigned to the correct user after the split. 

![How to split users in PostHog](../../images/docs/data/actions/how-to-split-users.mp4)
